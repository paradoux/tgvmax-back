'use strict';

var base32Encode = require('base32-encode');
var xor = require('bitwise-xor');

function UserSecretCreator(partialUserSecret, lianaTwoFactorSecret) {
  this.perform = function () {
    var hash = xor(Buffer.from(partialUserSecret, 'hex'), Buffer.from(lianaTwoFactorSecret, 'hex'));

    return base32Encode(hash, 'RFC3548').replace(/=/g, '');
  };
}

module.exports = UserSecretCreator;